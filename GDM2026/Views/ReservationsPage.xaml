<?xml version="1.0" encoding="utf-8" ?>
<ContentPage
    x:Class="GDM2026.ReservationsPage"
    xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
    xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
    xmlns:vm="clr-namespace:GDM2026.ViewModels"
    Title="Reservations">

    <ContentPage.BindingContext>
        <vm:ReservationsViewModel />
    </ContentPage.BindingContext>

    <ContentPage.Content>
        <Grid RowDefinitions="Auto,*" Padding="16">
            <VerticalStackLayout Grid.Row="0" Spacing="12">
                <Label Text="Planning" FontSize="24" FontAttributes="Bold" />
                <Label Text="{Binding StatusMessage}" FontSize="12" TextColor="Gray" />

                <Button Text="Ajouter un planning" Command="{Binding ToggleCreateFormCommand}" />

                <Frame Padding="12" BorderColor="LightGray" HasShadow="False" IsVisible="{Binding IsFormVisible}">
                    <VerticalStackLayout Spacing="8">
                        <Label Text="Jour" FontAttributes="Bold" />
                        <DatePicker Date="{Binding PlanningDay}" />

                        <Label Text="Heure de début" FontAttributes="Bold" />
                        <TimePicker Time="{Binding StartTime}" />

                        <Label Text="Heure de fin" FontAttributes="Bold" />
                        <TimePicker Time="{Binding EndTime}" />

                        <Button Text="Créer le planning" Command="{Binding CreateCommand}" />
                    </VerticalStackLayout>
                </Frame>
            </VerticalStackLayout>

            <RefreshView Grid.Row="1" Command="{Binding RefreshCommand}" IsRefreshing="{Binding IsLoading}">
                <CollectionView ItemsSource="{Binding Reservations}" VerticalOptions="FillAndExpand">
                    <CollectionView.EmptyView>
                        <Label Text="Aucun planning à afficher." HorizontalOptions="Center" VerticalOptions="Center" />
                    </CollectionView.EmptyView>

                    <CollectionView.ItemTemplate>
                        <DataTemplate>
                            <Frame Padding="10" Margin="0,4" HasShadow="False" BorderColor="LightGray">
                                <VerticalStackLayout Spacing="4">
                                    <Label Text="{Binding DisplayTitle}" FontAttributes="Bold" />
                                    <Label Text="{Binding DisplayDay}" />
                                    <Label Text="{Binding DisplayTimeRange}" FontSize="12" TextColor="Gray" />
                                </VerticalStackLayout>
                            </Frame>
                        </DataTemplate>
                    </CollectionView.ItemTemplate>
                </CollectionView>
            </RefreshView>
        </Grid>
    </ContentPage.Content>
</ContentPage>
