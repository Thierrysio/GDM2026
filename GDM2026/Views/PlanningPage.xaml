<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="GDM2026.PlanningPage"
             x:Name="PlanningPageRoot"
             BackgroundColor="#0B0B0B"
             Title="Planning">
    <ContentPage.Resources>
        <Color x:Key="GoldText">#D4AF37</Color>
        <Color x:Key="CardBackground">#151515</Color>
    </ContentPage.Resources>

    <ScrollView>
        <VerticalStackLayout Padding="24" Spacing="18">
            <Border
                Background="{StaticResource CardBackground}"
                Stroke="#000000"
                StrokeThickness="1.5"
                Padding="20">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="18" />
                </Border.StrokeShape>

                <VerticalStackLayout Spacing="16">
                    <Label
                        Text="Planning"
                        FontSize="28"
                        FontAttributes="Bold"
                        HorizontalTextAlignment="Center"
                        TextColor="{StaticResource GoldText}" />

                    <Label
                        Text="Ordonnez vos crÃ©neaux en suivant la mÃªme expÃ©rience que les ActualitÃ©s."
                        FontSize="16"
                        HorizontalTextAlignment="Center"
                        TextColor="{StaticResource GoldText}"
                        Opacity="0.85" />

                    <VerticalStackLayout Spacing="10">
                        <Button
                            Text="+ Nouveau crÃ©neau"
                            BackgroundColor="#303030"
                            TextColor="{StaticResource GoldText}"
                            Command="{Binding ShowCreatePanelCommand}" />
                        <Button
                            Text="Mettre Ã  jour un crÃ©neau"
                            BackgroundColor="#303030"
                            TextColor="{StaticResource GoldText}"
                            Command="{Binding ShowUpdatePanelCommand}" />
                        <Button
                            Text="ðŸ”„ Charger les crÃ©neaux"
                            BackgroundColor="#252525"
                            TextColor="{StaticResource GoldText}"
                            Command="{Binding RefreshCommand}" />
                    </VerticalStackLayout>

                    <Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
                        <Label
                            Text="{Binding StatusMessage}"
                            FontSize="14"
                            Opacity="0.85"
                            TextColor="{StaticResource GoldText}"
                            LineBreakMode="WordWrap" />
                        <ActivityIndicator
                            Grid.Column="1"
                            IsRunning="{Binding IsLoading}"
                            IsVisible="{Binding IsLoading}"
                            Color="{StaticResource GoldText}" />
                    </Grid>
                </VerticalStackLayout>
            </Border>

            <Border
                IsVisible="{Binding IsUpdateMode}"
                Background="#1E1E1E"
                Padding="14"
                Stroke="#2D2D2D">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="14" />
                </Border.StrokeShape>
                <VerticalStackLayout Spacing="12">
                    <Label
                        Text="SÃ©lectionnez un crÃ©neau Ã  modifier"
                        FontAttributes="Bold"
                        TextColor="{StaticResource GoldText}" />

                    <ActivityIndicator
                        IsRunning="{Binding IsLoading}"
                        IsVisible="{Binding IsLoading}"
                        Color="{StaticResource GoldText}" />

                    <CollectionView
                        ItemsSource="{Binding Plannings}"
                        SelectionMode="Single"
                        SelectedItem="{Binding SelectedPlanning}"
                        HeightRequest="230">
                        <CollectionView.ItemsLayout>
                            <LinearItemsLayout Orientation="Vertical" ItemSpacing="8" />
                        </CollectionView.ItemsLayout>
                        <CollectionView.EmptyView>
                            <Label
                                Text="Aucun crÃ©neau n'a encore Ã©tÃ© chargÃ©."
                                TextColor="{StaticResource GoldText}"
                                HorizontalTextAlignment="Center"
                                Opacity="0.6" />
                        </CollectionView.EmptyView>
                        <CollectionView.ItemTemplate>
                            <DataTemplate>
                                <Border Background="#111" Stroke="#2D2D2D" StrokeThickness="1" Padding="10" Margin="0,4">
                                    <Border.StrokeShape>
                                        <RoundRectangle CornerRadius="12" />
                                    </Border.StrokeShape>
                                    <VerticalStackLayout Spacing="4">
                                        <Label
                                            Text="{Binding DisplayDate}"
                                            TextColor="{StaticResource GoldText}"
                                            FontAttributes="Bold" />
                                        <Label
                                            Text="{Binding DisplayHours}"
                                            TextColor="{StaticResource GoldText}"
                                            FontSize="13" />
                                    </VerticalStackLayout>
                                </Border>
                            </DataTemplate>
                        </CollectionView.ItemTemplate>
                    </CollectionView>

                    <Label
                        Text="{Binding SelectedPlanningLabel}"
                        TextColor="{StaticResource GoldText}"
                        FontSize="13"
                        Opacity="0.8"
                        HorizontalTextAlignment="Center" />
                </VerticalStackLayout>
            </Border>

            <Border
                IsVisible="{Binding IsFormSectionVisible}"
                Background="#1E1E1E"
                Padding="14"
                Stroke="#2D2D2D">
                <Border.StrokeShape>
                    <RoundRectangle CornerRadius="14" />
                </Border.StrokeShape>
                <VerticalStackLayout Spacing="12">
                    <Label
                        Text="{Binding FormTitle}"
                        FontAttributes="Bold"
                        TextColor="{StaticResource GoldText}"
                        FontSize="20" />

                    <Label
                        Text="{Binding FormHelperMessage}"
                        TextColor="{StaticResource GoldText}"
                        FontSize="13"
                        Opacity="0.8" />

                    <VerticalStackLayout Spacing="12" IsVisible="{Binding IsCreateMode}">
                        <Label Text="Date du crÃ©neau" TextColor="{StaticResource GoldText}" FontAttributes="Bold" />
                        <DatePicker
                            Date="{Binding NewJour}"
                            TextColor="{StaticResource GoldText}"
                            BackgroundColor="#121212" />

                        <Grid ColumnDefinitions="*,*" ColumnSpacing="12">
                            <VerticalStackLayout Spacing="6">
                                <Label Text="DÃ©but" TextColor="{StaticResource GoldText}" FontAttributes="Bold" />
                                <TimePicker
                                    Time="{Binding NewHeureDebut}"
                                    TextColor="{StaticResource GoldText}"
                                    BackgroundColor="#121212" />
                            </VerticalStackLayout>
                            <VerticalStackLayout Spacing="6" Grid.Column="1">
                                <Label Text="Fin" TextColor="{StaticResource GoldText}" FontAttributes="Bold" />
                                <TimePicker
                                    Time="{Binding NewHeureFin}"
                                    TextColor="{StaticResource GoldText}"
                                    BackgroundColor="#121212" />
                            </VerticalStackLayout>
                        </Grid>

                        <Button
                            Text="CrÃ©er ce crÃ©neau"
                            Command="{Binding CreateCommand}"
                            BackgroundColor="#C18F1A"
                            TextColor="{StaticResource GoldText}" />
                    </VerticalStackLayout>

                    <VerticalStackLayout Spacing="12" IsVisible="{Binding IsUpdateMode}">
                        <Label Text="Jour" TextColor="{StaticResource GoldText}" FontAttributes="Bold" />
                        <DatePicker
                            Date="{Binding EditJour}"
                            TextColor="{StaticResource GoldText}"
                            BackgroundColor="#121212" />

                        <Grid ColumnDefinitions="*,*" ColumnSpacing="12">
                            <VerticalStackLayout Spacing="6">
                                <Label Text="DÃ©but" TextColor="{StaticResource GoldText}" FontAttributes="Bold" />
                                <TimePicker
                                    Time="{Binding EditHeureDebut}"
                                    TextColor="{StaticResource GoldText}"
                                    BackgroundColor="#121212" />
                            </VerticalStackLayout>
                            <VerticalStackLayout Spacing="6" Grid.Column="1">
                                <Label Text="Fin" TextColor="{StaticResource GoldText}" FontAttributes="Bold" />
                                <TimePicker
                                    Time="{Binding EditHeureFin}"
                                    TextColor="{StaticResource GoldText}"
                                    BackgroundColor="#121212" />
                            </VerticalStackLayout>
                        </Grid>

                        <Grid ColumnDefinitions="*,Auto" ColumnSpacing="12">
                            <Button
                                Text="Mettre Ã  jour"
                                Command="{Binding UpdateCommand}"
                                BackgroundColor="#303030"
                                TextColor="{StaticResource GoldText}" />
                            <Button
                                Grid.Column="1"
                                Text="Supprimer"
                                Command="{Binding DeleteCommand}"
                                BackgroundColor="#7A1C1C"
                                TextColor="{StaticResource GoldText}" />
                        </Grid>
                    </VerticalStackLayout>
                </VerticalStackLayout>
            </Border>
        </VerticalStackLayout>
    </ScrollView>
</ContentPage>
